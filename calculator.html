<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resource Calculator</title>
    <link rel="icon" href="img/icon.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400  ;500;600;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css  ">
    <script src="https://unpkg.com/lenis@1.1.18/dist/lenis.min.js  "></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
</head>

<body class="layout-wrapper">

    <section class="hero-section calculator-header">
        <a href="index.html" class="logo-link">
            <div class="pill-nav logo-pill glass-effect">
                <img src="img/big-logo.png" alt="Logo" class="logo-big">
                <img src="img/small-logo.png" alt="Logo" class="logo-small">
            </div>
        </a>

        <div class="menu-toggle glass-effect">Menu</div>

        <div class="nav-wrapper">
            <nav class="pill-nav main-nav glass-effect">
                <div class="nav-item" data-target="company">Company <svg class="arrow" width="10" height="6"
                        viewBox="0 0 10 6" fill="none">
                        <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg></div>
                <div class="nav-item active" data-target="resources">Resources <svg class="arrow" width="10" height="6"
                        viewBox="0 0 10 6" fill="none">
                        <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg></div>
                <div class="nav-item" data-target="contact">Contact us <svg class="arrow" width="10" height="6"
                        viewBox="0 0 10 6" fill="none">
                        <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg></div>
                <div class="nav-item simple">Partners</div>
            </nav>

            <div class="submenu-container">
                <div id="company" class="pill-nav sub-nav glass-effect">
                    <div class="nav-item icon-item"><span class="icon">❶</span> About us</div>
                    <div class="nav-item icon-item"><span class="icon">❶</span> Use Cases</div>
                </div>
                <div id="resources" class="pill-nav sub-nav glass-effect active-sub">
                    <a href="calculator.html" class="nav-item icon-item" style="text-decoration: none; color: inherit;">
                        <span class="icon">❶</span> Calculator
                    </a>
                    <div class="nav-item icon-item"><span class="icon">❶</span> Help & Support</div>
                    <div class="nav-item icon-item"><span class="icon">❶</span> Blog</div>
                </div>
                <div id="contact" class="pill-nav sub-nav glass-effect">
                    <div class="nav-item icon-item"><span class="icon">❶</span> Reach Out</div>
                    <a href="https://calendly.com/kateleo-mail/30min  " class="nav-item icon-item"
                        style="text-decoration: none; color: inherit;" target="_blank">
                        <span class="icon">❶</span> Schedule a Meeting
                    </a>
                </div>
            </div>
        </div>

        <div class="header-title-container">
            <h1 data-aos="fade-down" data-aos-offset="0">RESOURCE CALCULATOR</h1>
        </div>
    </section>

    <section class="gradient-section calc-page-section">
        <div class="gradient-container">

            <div class="calc-grid-container" data-aos="fade-up">

                <div class="glass-wrapper">
                    <div class="calc-card white-glass">
                        <h2 class="calc-h2">SERVER AND CLIENT RESOURCE CALCULATOR</h2>
                        <p class="calc-desc">The calculation is approximate and should be used for reference only.
                            Actual numbers will always differ from calculated ones!</p>

                        <form name="calcform" class="calc-form" onsubmit="return false;">

                            <input type="checkbox" name="onlines_audio" style="display:none;">
                            <input type="checkbox" name="pp_audio" style="display:none;">

                            <div class="calc-row">
                                <label>Number of online clients:</label>
                                <input type="number" name="num_onlines">
                            </div>
                            <div class="calc-row">
                                <label>Screenshot interval (sec):</label>
                                <input type="number" name="onlines_sshots_interval">
                            </div>
                            <div class="calc-row checkbox-row">
                                <label>Use proxy server:</label>
                                <div class="cb-wrap">
                                    <input type="checkbox" id="p1"><label for="p1">Yes</label>
                                </div>
                            </div>

                            <hr class="calc-hr">

                            <div class="calc-row">
                                <div class="label-col">
                                    <label>Number of deferred clients:</label>
                                    <span class="small-text">Deferred clients work in deferred monitoring mode...</span>
                                </div>
                                <input type="number" name="num_pp">
                            </div>
                            <div class="calc-row">
                                <label>Screenshot interval (sec):</label>
                                <input type="number" name="pp_sshots_interval">
                            </div>
                            <div class="calc-row checkbox-row">
                                <label>Use proxy server:</label>
                                <div class="cb-wrap">
                                    <input type="checkbox" id="p2"><label for="p2">Yes</label>
                                </div>
                            </div>

                            <hr class="calc-hr">

                            <div class="calc-row">
                                <div class="label-col">
                                    <label>Average screenshot size (KB):</label>
                                    <span class="small-text">Advanced size depends heavily on quality settings (usually
                                        25 KB is minimum).</span>
                                </div>
                                <input type="number" name="avg_sshot_size">
                            </div>
                            <div class="calc-row">
                                <div class="label-col">
                                    <label>Average shadow copy volume (MB):</label>
                                    <span class="small-text">Specify approximate average volume of files sent to
                                        Internet/email/flash per user per day.</span>
                                </div>
                                <input type="number" name="avg_sc_size">
                            </div>

                            <div class="calc-row">
                                <label>Data retention period (days):</label>
                                <input type="number" name="retro">
                            </div>

                            <div class="calc-row radio-row">
                                <label>Working days per week:</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="workdays" value="4"> 4 days</label>
                                    <label><input type="radio" name="workdays" value="5"> 5 days</label>
                                    <label><input type="radio" name="workdays" value="6"> 6 days</label>
                                    <label><input type="radio" name="workdays" value="7"> 7 days</label>
                                </div>
                            </div>

                            <div class="calc-row checkbox-row">
                                <label>SQL server location:</label>
                                <div class="cb-wrap">
                                    <input type="checkbox" id="p3" name="sql_shared"><label for="p3">Use the same
                                        machine with main server</label>
                                </div>
                            </div>

                            <button class="calc-black-btn" onclick="runCalculation(event)">Calculate Resources</button>
                        </form>
                    </div>
                </div>

                <div class="glass-wrapper">
                    <div class="calc-card white-glass">
                        <h2 class="calc-h2">CALCULATION RESULTS:</h2>

                        <div class="results-list" id="results">
                            <div class="res-row">
                                <span>Traffic from one online client to server:</span>
                                <input type="text" name="res_onlines_traffic" readonly placeholder="0.00">
                            </div>
                            <div class="res-row">
                                <span>Total traffic from all clients to server:</span>
                                <input type="text" name="res_summary_traffic" readonly placeholder="0.00">
                            </div>
                            <div class="res-row">
                                <span>Required space on deferred machines:</span>
                                <input type="text" name="res_pp_space" readonly placeholder="0.00">
                            </div>
                            <div class="res-row">
                                <span>Required server space for shadow copies:</span>
                                <input type="text" name="res_server_space" readonly placeholder="0.00">
                            </div>
                            <div class="res-row">
                                <span>Recommended server drive type:</span>
                                <input type="text" name="res_server_drive" readonly placeholder="--">
                            </div>
                            <div class="res-row">
                                <span>Estimated SQL database size:</span>
                                <input type="text" name="res_sql_space" readonly placeholder="0.00">
                            </div>
                            <div class="res-row">
                                <span>Recommended drive type for SQL database:</span>
                                <input type="text" name="res_sql_drive" readonly placeholder="--">
                            </div>

                            <div class="res-row res-multiline">
                                <span>Recommended SQL server edition:</span>
                                <textarea name="res_sql_edition" readonly placeholder="--"></textarea>
                            </div>


                            <div class="res-row">
                                <span>Recommended server CPU cores:</span>
                                <input type="text" name="res_server_cores" readonly placeholder="0">
                            </div>
                            <div class="res-row">
                                <span>Recommended server RAM (GB):</span>
                                <input type="text" name="res_server_ram" readonly placeholder="0">
                            </div>

                            <div class="res-row" id="res_sql_cores_row">
                                <span>Recommended SQL server CPU cores:</span>
                                <input type="text" name="res_sql_cores" id="res_sql_cores" readonly placeholder="0">
                            </div>
                            <div class="res-row" id="res_sql_ram_row">
                                <span>Recommended SQL server RAM (GB):</span>
                                <input type="text" name="res_sql_ram" id="res_sql_ram" readonly placeholder="0">
                            </div>
                            <button class="calc-black-btn" onclick="downloadReport()"
                                style="display: flex; justify-content: center; align-items: center; gap: 10px;">
                                Download Report
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 3V17M12 17L17 12M12 17L7 12M4 21H20" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                        </div>
                    </div>

                </div>

            </div>
    </section>

    <section class="contact-section">
        <div class="contact-container" data-aos="fade-up">
            <h2 class="contact-title">HAVE QUESTIONS?<br>GET IN TOUCH!</h2>

            <div class="contact-content-grid">

                <div class="contact-info">
                    <div class="info-group">
                        <label>Office</label>
                        <p>0711, Georgia, Tbilisi, Saburtalo District, Givi Kartozia Street, No. 8 Building No. 5, Flat
                            No. 92</p>
                    </div>

                    <div class="info-group">
                        <label>Phone</label>
                        <p>International & Premium Product sales:<br>
                            <a href="tel:+995598888826">+995598888826</a>
                        </p>
                        <p>Please contact us via Business WhatsApp<br>
                            <a href="https://wa.me/995598888826  " class="wa-link" target="_blank">WA Business</a>
                        </p>
                    </div>

                    <div class="info-group">
                        <label>Email</label>
                        <p>General questions<br>
                            <a href="mailto:info@scopd.net">info@scopd.net</a>
                        </p>
                    </div>
                </div>


                <form class="contact-form">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" placeholder="">
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" placeholder="">
                    </div>

                    <div class="form-group">
                        <label for="message">Enter Your Message</label>
                        <textarea id="message" name="message" rows="4"></textarea>
                        <span class="char-count">0/100</span>
                    </div>

                    <div class="form-checkbox">
                        <input type="checkbox" id="terms" name="terms" required>
                        <label for="terms">I accept the Terms</label>
                    </div>

                    <button type="submit" class="submit-btn">
                        Submit
                        <span class="submit-arrow">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                xmlns="http://www.w3.org/2000/svg  ">
                                <path d="M1 13L13 1M13 1H1M13 1V13" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </span>
                    </button>
                </form>
            </div>
        </div>
    </section>

    <div class="footer-wrapper">
        <footer class="main-footer">
            <div class="footer-container" data-aos="fade-up">

                <div class="footer-top-section">

                    <div class="footer-nav-links">
                        <div class="footer-col">
                            <h4>Company</h4>
                            <a href="#">About Us</a>
                            <a href="#">Use Cases</a>
                        </div>
                        <div class="footer-col">
                            <h4>Resources</h4>
                            <a href="calculator.html">Calculator</a>
                            <a href="#">Help & Support</a>
                            <a href="#">Blog</a>
                        </div>
                        <div class="footer-col">
                            <h4>Contact Us</h4>
                            <a href="#">Reach Out</a>
                            <a href="https://calendly.com/kateleo-mail/30min  " target="_blank">Schedule a Meeting</a>
                        </div>
                        <div class="footer-col">
                            <h4>Quick Links</h4>
                            <a href="#">Partners</a>
                            <a href="#">Plans</a>
                            <a href="#">Request Demo</a>
                        </div>
                        <div class="footer-col">
                            <h4>Socials</h4>
                            <a href="https://www.linkedin.com/company/scopd-llc/about/  " target="_blank">Linkedin</a>
                            <a href="https://www.facebook.com/profile.php?id=61565695336082  "
                                target="_blank">Facebook</a>
                            <a href="https://wa.me/995598888826  " target="_blank">WhatsApp</a>
                        </div>
                    </div>

                    <div class="footer-subscribe">
                        <h4>Subscribe to newsletter</h4>
                        <div class="subscribe-form">
                            <input type="email" placeholder="Your email address">
                            <button type="button">Get started</button>
                        </div>
                    </div>
                </div>

                <div class="footer-bottom-section">

                    <div class="footer-brand-left">
                        <div class="footer-logo-text">
                            <img src="img/big-white-logo.png" alt="scopd" class="scopd-text-logo">
                        </div>
                        <p class="footer-tagline">Objective data is the basis of an effective business</p>

                        <div class="footer-legal-row">
                            <span class="copyright">©scopd, Inc. 2026</span>
                            <a href="#">Term of Services</a>
                            <a href="#">Privacy Policy</a>
                            <a href="#">Cookies Settings</a>
                        </div>
                    </div>

                    <div class="footer-extras-right">
                        <div class="certs-wrapper">
                            <img src="img/certificates.jpg" alt="ISO Certificates" class="certs-img">
                        </div>

                        <a href="#" class="scroll-top-btn glass-effect" aria-label="Scroll to top">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg  ">
                                <path d="M12 19V5M12 5L5 12M12 5L19 12" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </a>
                    </div>

                </div>
            </div>
        </footer>

        <div class="side-menu-overlay">
            <div class="side-menu-content">
                <button class="close-menu-btn">Close</button>
                <div class="menu-section">
                    <a href=index.html
                        style="font-family: 'Inter', sans-serif; font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 16px;">Home</a>
                </div>
                <hr class="menu-divider">

                <div class="menu-sections">
                    <div class="menu-section">
                        <h3>Company</h3>
                        <a href="#">About Us</a>
                        <a href="#">Use Cases</a>
                    </div>

                    <div class="menu-section">
                        <h3>Resources</h3>
                        <a href="calculator.html">Calculator</a>
                        <a href="#">Help & Support</a>
                        <a href="#">Blog</a>
                    </div>

                    <div class="menu-section">
                        <h3>Contact Us</h3>
                        <a href="#">Reach Out</a>
                        <a href="https://calendly.com/kateleo-mail/30min  " target="_blank">Schedule a Meeting</a>
                    </div>
                </div>

                <hr class="menu-divider">

                <div class="menu-footer-links">
                    <a href="#">Partners</a>
                </div>
            </div>
        </div>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const menuToggle = document.querySelector('.menu-toggle');
                const sideMenuOverlay = document.querySelector('.side-menu-overlay');
                const closeMenuBtn = document.querySelector('.close-menu-btn');

                if (menuToggle && sideMenuOverlay) {
                    menuToggle.addEventListener('click', () => {
                        sideMenuOverlay.classList.add('active'); // Добавляем класс для показа
                        document.body.style.overflow = 'hidden'; // Блокируем прокрутку фона
                    });
                }

                if (closeMenuBtn && sideMenuOverlay) {
                    closeMenuBtn.addEventListener('click', () => {
                        sideMenuOverlay.classList.remove('active');
                        document.body.style.overflow = '';
                    });
                }

                if (sideMenuOverlay) {
                    sideMenuOverlay.addEventListener('click', (e) => {
                        if (e.target === sideMenuOverlay) {
                            sideMenuOverlay.classList.remove('active');
                            document.body.style.overflow = '';
                        }
                    });
                }
            });
        </script>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js  "></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js  "></script>
    <script src="script.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const menuToggle = document.querySelector('.menu-toggle');
            const navWrapper = document.querySelector('.nav-wrapper');

            if (menuToggle && navWrapper) {
                menuToggle.addEventListener('click', function () {
                    navWrapper.classList.toggle('active');

                    menuToggle.classList.toggle('active');

                    if (navWrapper.classList.contains('active')) {
                        menuToggle.textContent = 'Close';
                    } else {
                        menuToggle.textContent = 'Menu';
                    }
                });
            }
        });
    </script>

    <script>
        function ResCalc() {


            this.GetControl = function (name) {

                if (document.forms['calcform'] && document.forms['calcform'].elements[name]) {
                    return document.forms['calcform'].elements[name];
                }

                let els = document.getElementsByName(name);
                if (els.length > 0) return els[0];
                return null;
            }


            this.Form = function () {
                return document.forms['calcform'];
            }

            this.GetFieldValue = function (name, v_min, v_max) {
                let control = this.GetControl(name);
                if (!control) throw ('Error: cannot find field ' + name);

                let v = parseInt(control.value);
                if (isNaN(v) || v < v_min || v > v_max) {
                    control.focus();
                    if (control.select) control.select();
                    alert('Please enter a value between ' + v_min + ' and ' + v_max);
                    throw ('Validation error');
                }
                return v;
            }

            this.GetFieldChecked = function (name) {
                let control = this.GetControl(name);
                if (!control) return false;
                return control.checked;
            }

            this.SetFieldSimple = function (name, value) {
                let control = this.GetControl(name);
                if (control) {
                    control.value = value;
                }
            }

            this.SetFieldTraffic = function (name, Bps) {
                let bps = Bps * 8;
                let s;
                if (bps == 0) s = '-';
                else if (bps < 1024) s = bps + ' bits/s';
                else if (bps < 1024 * 1024) s = Math.round(bps / 1024) + ' Kbits/s';
                else if (bps < 10 * 1024 * 1024) s = Math.round(bps / 1024 / 1024 * 10) / 10 + ' Mbits/s';
                else if (bps < 1000 * 1024 * 1024) s = Math.round(bps / 1024 / 1024) + ' Mbits/s';
                else s = Math.round(bps / 1024 / 1024 / 1000 * 10) / 10 + ' Gbits/s';

                this.SetFieldSimple(name, s);
            }

            this.SetFieldSize = function (name, bytes) {
                let s;
                if (bytes == 0) s = '-';
                else if (bytes < 1024) s = bytes + ' B';
                else if (bytes < 1024 * 1024) s = Math.round(bytes / 1024) + ' KB';
                else if (bytes < 1024 * 1024 * 1024) s = Math.round(bytes / 1024 / 1024) + ' MB';
                else if (bytes < 1000 * 1024 * 1024 * 1024) s = Math.round(bytes / 1024 / 1024 / 1024) + ' GB';
                else s = Math.round(bytes / 1024 / 1024 / 1024 / 1000 * 10) / 10 + ' TB';

                this.SetFieldSimple(name, s);
            }

            this.Calc = function () {
                try {
                    const max_connections = 25000;
                    const audio_traffic_Bps = 2000;

                    let num_onlines = this.GetFieldValue('num_onlines', 0, max_connections);
                    let onlines_sshots_interval = this.GetFieldValue('onlines_sshots_interval', 0, 3600);
                    onlines_sshots_interval = onlines_sshots_interval > 0 ? onlines_sshots_interval : 10000000;
                    let onlines_audio = this.GetFieldChecked('onlines_audio');

                    let num_pp = this.GetFieldValue('num_pp', 0, max_connections);
                    let pp_sshots_interval = this.GetFieldValue('pp_sshots_interval', 0, 3600);
                    pp_sshots_interval = pp_sshots_interval > 0 ? pp_sshots_interval : 10000000;
                    let pp_audio = this.GetFieldChecked('pp_audio');

                    if (num_onlines + num_pp > max_connections) {
                        alert('Total machines exceed ' + max_connections);
                        return;
                    } else if (num_onlines + num_pp == 0) {
                        alert('Total machines equal 0');
                        return;
                    }

                    let avg_sshot_size = this.GetFieldValue('avg_sshot_size', 5, 1000) * 1024;
                    let avg_sc_size_per_sec = this.GetFieldValue('avg_sc_size', 0, 1000) * 1024 * 1024 / (9 * 60 * 60);
                    let retro = this.GetFieldValue('retro', 1, 1000);


                    let workdays = 5;
                    let wd_radios = document.getElementsByName('workdays');
                    for (let i = 0; i < wd_radios.length; i++) {
                        if (wd_radios[i].checked) workdays = parseInt(wd_radios[i].value);
                    }

                    let sql_shared = this.GetFieldChecked('sql_shared');

                    let k_sec2retro = (workdays / 7) * retro * 9 * 3600;

                    let res_pp_traffic = 10;
                    let res_onlines_traffic = 20 + avg_sshot_size / onlines_sshots_interval + (onlines_audio ? audio_traffic_Bps : 0) + avg_sc_size_per_sec;
                    let res_summary_traffic = res_pp_traffic * num_pp + res_onlines_traffic * num_onlines;
                    let res_pp_space = k_sec2retro * (20 + avg_sshot_size / pp_sshots_interval + (pp_audio ? audio_traffic_Bps : 0) + avg_sc_size_per_sec);
                    let res_server_space = k_sec2retro * (num_onlines * (avg_sshot_size / onlines_sshots_interval + (onlines_audio ? audio_traffic_Bps : 0) + avg_sc_size_per_sec));
                    let res_server_drive = 'HDD';
                    let res_sql_space = num_onlines * 1300000 * (retro * (workdays / 7));
                    let res_sql_drive = num_onlines < 300 ? 'HDD' : 'SSD';
                    let res_sql_edition = res_sql_space < 8000000000 ? 'SQL Server Express / PostgreSQL' : 'SQL Server Standard / PostgreSQL';
                    let res_server_cores = Math.round(4 + 4 * (num_onlines * 1.0 + num_pp * 1.0) / 10000);
                    let res_server_ram = Math.round(4 + 20 * (num_onlines * 1.0 + num_pp * 1.0) / 25000);
                    let res_sql_cores = Math.round(1 + 3 * (num_onlines) / 25000);
                    let res_sql_ram = Math.round(3 + 10 * (num_onlines) / 25000);

                    let vis_sql;

                    if (sql_shared) {
                        res_server_cores += res_sql_cores;
                        res_sql_cores = 0;
                        res_server_ram += res_sql_ram;
                        res_sql_ram = 0;
                        vis_sql = false;
                    } else {
                        res_sql_cores += 1;
                        res_sql_ram += 1;
                        vis_sql = true;
                    }

                    this.SetFieldTraffic('res_onlines_traffic', res_onlines_traffic);
                    this.SetFieldTraffic('res_summary_traffic', res_summary_traffic);
                    this.SetFieldSize('res_pp_space', res_pp_space);
                    this.SetFieldSize('res_server_space', res_server_space);
                    this.SetFieldSimple('res_server_drive', res_server_drive);
                    this.SetFieldSize('res_sql_space', res_sql_space);
                    this.SetFieldSimple('res_sql_drive', res_sql_drive);
                    this.SetFieldSimple('res_sql_edition', res_sql_edition);
                    this.SetFieldSimple('res_server_cores', res_server_cores);
                    this.SetFieldSimple('res_server_ram', res_server_ram);
                    this.SetFieldSimple('res_sql_cores', res_sql_cores);
                    this.SetFieldSimple('res_sql_ram', res_sql_ram);


                    document.getElementById('results').style.display = '';
                    let sqlCoresRow = document.getElementById('res_sql_cores_row');
                    let sqlRamRow = document.getElementById('res_sql_ram_row');

                    if (sqlCoresRow) sqlCoresRow.style.display = vis_sql ? '' : 'none';
                    if (sqlRamRow) sqlRamRow.style.display = vis_sql ? '' : 'none';

                } catch (e) {
                    console.error(e);
                    return false;
                }
            }
        }

        const calculator = new ResCalc();

        function runCalculation(e) {
            e.preventDefault();
            calculator.Calc();
        }
    </script>



    <script>
        function getElementValue(name, type = 'text') {
            let els = document.getElementsByName(name);

            if (name === 'p1') els = [document.getElementById('p1')];
            if (name === 'p2') els = [document.getElementById('p2')];

            if (!els || els.length === 0 || !els[0]) return '-';

            if (type === 'radio') {
                for (let i = 0; i < els.length; i++) {
                    if (els[i].checked) return els[i].parentElement.textContent.trim();
                }
                return '5 days';
            }

            if (type === 'checkbox' || name === 'p1' || name === 'p2') {
                return els[0].checked ? 'Yes' : 'No';
            }

            return els[0].value ? els[0].value : (els[0].placeholder || '-');
        }



        async function getBase64Image(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.setAttribute('crossOrigin', 'anonymous');
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    const dataURL = canvas.toDataURL('image/png');
                    resolve(dataURL);
                };
                img.onerror = () => {
                    resolve(null);
                };
                img.src = url;
            });
        }

        async function downloadReport() {
            const logoData = await getBase64Image('img/big-logo.png');

            const inputs = [
                { label: 'Number of online clients', name: 'num_onlines' },
                { label: 'Screenshot interval (Online)', name: 'onlines_sshots_interval', suffix: ' sec' },
                { label: 'Use proxy (Online)', name: 'p1', type: 'checkbox' },
                { label: 'Number of deferred clients', name: 'num_pp' },
                { label: 'Screenshot interval (Deferred)', name: 'pp_sshots_interval', suffix: ' sec' },
                { label: 'Use proxy (Deferred)', name: 'p2', type: 'checkbox' },
                { label: 'Avg screenshot size', name: 'avg_sshot_size', suffix: ' KB' },
                { label: 'Avg shadow copy volume', name: 'avg_sc_size', suffix: ' MB' },
                { label: 'Data retention period', name: 'retro', suffix: ' days' },
                { label: 'Working days per week', name: 'workdays', type: 'radio' },
                { label: 'SQL server location', name: 'sql_shared', type: 'checkbox' }
            ];

            const results = [
                { label: 'Traffic from one online client', name: 'res_onlines_traffic' },
                { label: 'Total traffic from all clients', name: 'res_summary_traffic' },
                { label: 'Space on deferred machines', name: 'res_pp_space' },
                { label: 'Server space for shadow copies', name: 'res_server_space' },
                { label: 'Server drive type', name: 'res_server_drive' },
                { label: 'Estimated SQL database size', name: 'res_sql_space' },
                { label: 'Recommended SQL drive type', name: 'res_sql_drive' },
                { label: 'Recommended SQL server edition', name: 'res_sql_edition' },
                { label: 'Recommended server CPU cores', name: 'res_server_cores' },
                { label: 'Recommended server RAM', name: 'res_server_ram', suffix: ' GB' }
            ];

            const sqlCoresRow = document.getElementById('res_sql_cores_row');
            if (sqlCoresRow && sqlCoresRow.style.display !== 'none') {
                results.push({ label: 'Recommended SQL server CPU cores', name: 'res_sql_cores' });
                results.push({ label: 'Recommended SQL server RAM', name: 'res_sql_ram', suffix: ' GB' });
            }

            const buildTableBody = (data) => {
                return data.map(item => {
                    let val = getElementValue(item.name, item.type);
                    if (item.name === 'sql_shared') val = (val === 'Yes') ? 'Shared with main server' : 'Separate machine';
                    if (item.suffix && val !== '-' && val !== 'Yes' && val !== 'No') val += item.suffix;

                    return [
                        { text: item.label, style: 'tableLabel' },
                        { text: val, style: 'tableValue', alignment: 'right' }
                    ];
                });
            };

            const headerContent = [];
            if (logoData) {
                headerContent.push({
                    image: logoData,
                    width: 150,
                    alignment: 'center',
                    margin: [0, 0, 0, 10]
                });
            } else {
                headerContent.push({ text: 'SCOPD', style: 'headerLogoFallback', alignment: 'center', margin: [0, 0, 0, 10] });
            }

            var docDefinition = {
                pageSize: 'A4',
                pageMargins: [30, 30, 30, 30],

                info: {
                    title: 'Scopd Resource Report',
                    author: 'Scopd Inc.'
                },
                content: [
                    ...headerContent,

                    {
                        text: [
                            { text: 'RESOURCE CALCULATION REPORT\n', style: 'header' },
                            { text: 'View this calculator online', link: window.location.href, style: 'link', decoration: 'underline' }
                        ],
                        alignment: 'center',
                        margin: [0, 10, 0, 10]
                    },

                    {
                        text: 'This calculation is approximate and should be used for reference only, actual numbers will always differ from calculated ones!',
                        style: 'disclaimerTop',
                        alignment: 'center',
                        margin: [0, 0, 0, 15]
                    },

                    {
                        columns: [
                            {
                                width: '48%',
                                stack: [
                                    { text: 'Input Parameters', style: 'sectionHeader' },
                                    {
                                        table: {
                                            widths: ['60%', '40%'],
                                            body: buildTableBody(inputs)
                                        },
                                        layout: 'lightHorizontalLines'
                                    }
                                ]
                            },
                            {
                                width: '48%',
                                stack: [
                                    { text: 'Calculation Results', style: 'sectionHeader' },
                                    {
                                        table: {
                                            widths: ['60%', '40%'],
                                            body: buildTableBody(results)
                                        },
                                        layout: 'lightHorizontalLines'
                                    }
                                ]
                            }
                        ],
                        columnGap: 20
                    },

                    { text: '', margin: [0, 15, 0, 0] },
                    {
                        stack: [
                            { text: 'NOTES:', style: 'notesTitle' },

                            {
                                ul: [
                                    'Deferred clients work in deferred monitoring mode, they accumulate data locally and transfer to the server only on request (when generating relevant reports).',
                                    'Screenshot size depends heavily on quality settings (usually 25 KB is minimum).',
                                    'Shadow copy volume reference: Approximate average volume of files sent to Internet/email/flash per user per day.'
                                ],
                                style: 'notesList'
                            }
                        ],
                        margin: [0, 10, 0, 0]
                    },

                    { text: 'Generated by Scopd Resource Calculator | ' + new Date().toLocaleDateString(), style: 'footer', alignment: 'center', margin: [0, 20, 0, 0] }
                ],
                styles: {
                    header: { fontSize: 16, bold: true, color: '#333', margin: [0, 0, 0, 5] },
                    headerLogoFallback: { fontSize: 20, bold: true },
                    link: { fontSize: 10, color: 'blue', italics: true },
                    disclaimerTop: { fontSize: 10, color: '#e74c3c', bold: true, italics: true },
                    sectionHeader: { fontSize: 12, bold: true, color: 'white', fillColor: '#333', margin: [0, 0, 0, 5], padding: 4 },
                    tableLabel: { fontSize: 9, color: '#333', margin: [0, 2, 0, 2] },
                    tableValue: { fontSize: 9, bold: true, margin: [0, 2, 0, 2] },
                    notesTitle: { fontSize: 10, bold: true, margin: [0, 0, 0, 3] },
                    notesList: { fontSize: 9, color: '#555', margin: [0, 0, 0, 0] },
                    footer: { fontSize: 8, color: '#aaa', italics: true }
                }
            };

            pdfMake.createPdf(docDefinition).download('Scopd_Report.pdf');
        }
    </script>
</body>

</html>